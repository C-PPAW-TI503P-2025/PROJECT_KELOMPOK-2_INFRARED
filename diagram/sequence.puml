@startuml
title Sequence Diagram (Alur Deteksi & Penyimpanan)

actor "Pengguna" as User
participant "Sensor & Servo" as HW
participant "ESP32 Controller" as MCU
participant "Node.js Server" as Server
participant "SQLite DB" as DB
participant "Web Dashboard" as Web

' Sesi Deteksi
User -> HW : Membuang Sampah
activate HW
HW -> MCU : Sinyal Deteksi (Ada Objek)
activate MCU

MCU -> HW : Perintah Buka Servo
MCU -> Server : HTTP POST /api/trash
activate Server

Server -> DB : INSERT INTO trash_entries
activate DB
DB --> Server : Data Tersimpan
deactivate DB

Server --> MCU : Response 200 OK
deactivate Server
MCU -> HW : Perintah Tutup Servo
deactivate MCU
deactivate HW

' Sesi Monitoring
User -> Web : Buka Dashboard
activate Web
Web -> Server : Request Data Terbaru
activate Server
Server -> DB : SELECT * FROM trash_entries
activate DB
DB --> Server : Return Data JSON
deactivate DB
Server --> Web : Kirim Data
deactivate Server
Web -> Web : Render Grafik & Tabel

@enduml